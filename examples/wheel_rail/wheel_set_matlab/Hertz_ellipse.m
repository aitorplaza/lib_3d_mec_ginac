%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%   Calculates the a and b semiaxes of an ellipse               
%   using Hetz contact theory
%   N in newtons
%   R in m
%   E in Pa
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

function [a,b] = Hertz_ellipse(N,R,E,nu)

 R1x = R(1);
 R1y = R(2);
 R2x = R(3);
 R2y = R(4);

 A = 1/2*(1/R1y + 1/R2y);
 B = 1/2*(1/R1x + 1/R2x);

 THETA = acosd((A-B)/(A + B)) ;
 
 Thertz=[
 0.5, 61.4,0.1018;   1.0, 36.89, 0.1314; 1.5, 27.48, 0.1522; 2.0, 22.26, 0.1691; 3.0, 16.5, 0.1964;
 4.0, 13.31, 0.2188; 6.0, 9.79, 0.2552;  8.0, 7.86, 0.285 ;  10.0, 6.604, 0.3112; 20.0, 3.813, 0.4123;
 30.0, 2.731, 0.493; 35.0, 2.397, 0.53;  40.0, 2.136, 0.567; 45.0, 1.926, 0.6040; 50.0, 1.754, 0.6410;
 55.0, 1.611, 0.678; 60.0, 1.486, 0.717; 65.0, 1.378, 0.759; 70.0, 1.284, 0.802 ; 75.0, 1.202, 0.846;
 80.0, 1.128, 0.893; 85.0, 1.061, 0.944; 90.0, 1.000, 1.000; 
 ]; %Symmetric

 if THETA <= 90.0
   m = interp1(Thertz(:,1),Thertz(:,2),THETA); 
   n = interp1(Thertz(:,1),Thertz(:,3),THETA);
 else 
   aux =  THETA - 90.0;
   THETA = THETA - 2*(THETA - 90.0);
   n = interp1(Thertz(:,1),Thertz(:,2),THETA); 
   m = interp1(Thertz(:,1),Thertz(:,3),THETA); 
 end

  
 a = m * ((3/2)*N*(1-nu^2)/(E*(A+B)))^(1/3);
 b = n * ((3/2)*N*(1-nu^2)/(E*(A+B)))^(1/3);

 

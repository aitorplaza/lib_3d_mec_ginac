%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%   Calculates the Kalker's coefficients for a                  %
%   given contact ellipse and a given nu                        % 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

function coefficients = kalker_coeff(a,b,nu) 

nus = [0,0.25,0.5];
a_b = [0.1,0.2,0.3,0.4,0.5,0.6,0.7,0.8,0.9];
b_a = [1.0,0.9,0.8,0.7,0.6,0.5,0.4,0.3,0.2,0.1];

if a/b < 1.0 
C11=[
2.51, 3.31, 4.85;
2.59, 3.37, 4.81;
2.68, 3.44, 4.80;
2.78, 3.53, 4.82;
2.88, 3.62, 4.83;
2.98, 3.72, 4.91;
3.09, 3.81, 4.97;
3.19, 3.91, 5.05;
3.29, 4.01, 5.12;
]; 
c11 = interp2(nus,a_b,C11,nu,a/b);

C12=[
2.51, 2.52, 2.53;
2.59, 2.63, 2.66;
2.68, 2.75, 2.81;
2.78, 2.88, 2.98;
2.88, 3.01, 3.14;
2.98, 3.14, 3.31;
3.09, 3.28, 3.48;
3.19, 3.41, 3.65;
3.29, 3.54, 3.82;
];
c12 = interp2(nus,a_b,C12,nu,a/b);

C23=[
0.334, 0.473, 0.731;
0.483, 0.603, 0.809;
0.607, 0.715, 0.889;
0.720, 0.823, 0.977;
0.827, 0.929, 1.07;
0.930, 1.03, 1.18;
1.03, 1.14, 1.29;
1.13, 1.25, 1.40;
1.23, 1.36, 1.51;
];
c23 = interp2(nus,a_b,C23,nu,a/b);

C33=[
6.42, 8.28, 11.7;
3.46, 4.27, 5.66;
2.49, 2.96, 3.72;
2.02, 2.32, 2.77;
1.74, 1.93, 2.22;
1.56, 1.68, 1.86;
1.43, 1.50, 1.60;
1.34, 1.37, 1.42;
1.27, 1.27, 1.27;
];
c33 = interp2(nus,a_b,C33,nu,a/b);

end



if b/a <= 1.0

C11=[
3.40, 4.12, 5.20;
3.51, 4.22, 5.30; 
3.65, 4.36, 5.42; 
3.82, 4.54, 5.58;
4.06, 4.78, 5.80; 
4.37, 5.10, 6.11;
4.84, 5.57, 6.57;
5.57, 6.34, 7.34;
6.96, 7.78, 8.82;
10.7, 11.7, 12.9;
];
c11 = interp2(nus,b_a,C11,nu,b/a);

C12 = [
3.40, 3.67, 3.98;
3.51, 3.81, 4.16;
3.65, 3.99, 4.39;
3.82, 4.21, 4.67;
4.06, 4.50, 5.04;
4.37, 4.90, 5.56;
4.84, 5.48, 6.31;
5.57, 6.40, 7.51;
6.96, 8.14, 9.79;
10.7, 12.8, 16.0;
];
c12 = interp2(nus,b_a,C12,nu,b/a);

C23 = [
1.33, 1.47, 1.63;
1.44, 1.59, 1.77;
1.58, 1.75, 1.94;
1.76, 1.95, 2.18;
2.01, 2.23, 2.50;
2.35, 2.62, 2.96;
2.88, 3.24, 3.70;
3.79, 4.32, 5.01;
5.72, 6.63, 7.89;
12.2, 14.6, 18.0;
];
c23 = interp2(nus,b_a,C23,nu,b/a);

C33 = [
1.21, 1.19, 1.16;
1.16, 1.11, 1.06;
1.10, 1.04, 0.954;
1.05, 0.965, 0.852;
1.01, 0.892, 0.751;
0.958, 0.819, 0.650;
0.912, 0.747, 0.549;
0.868, 0.674, 0.446;
0.828, 0.601, 0.341;
0.795, 0.526, 0.228;
];
c33 = interp2(nus,b_a,C33,nu,b/a);

end


coefficients =[c11,c12,c23,c33];

end


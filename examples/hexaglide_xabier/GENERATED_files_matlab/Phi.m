function Phi_ = Phi(q,time,param)

x = q( 1 ); 
y = q( 2 ); 
z = q( 3 ); 
a = q( 4 ); 
b = q( 5 ); 
c = q( 6 ); 
a1 = q( 7 ); 
a2 = q( 8 ); 
a3 = q( 9 ); 
a4 = q( 10 ); 
a5 = q( 11 ); 
a6 = q( 12 ); 
b1 = q( 13 ); 
b2 = q( 14 ); 
b3 = q( 15 ); 
b4 = q( 16 ); 
b5 = q( 17 ); 
b6 = q( 18 ); 
s1 = q( 19 ); 
s2 = q( 20 ); 
s3 = q( 21 ); 
s4 = q( 22 ); 
s5 = q( 23 ); 
s6 = q( 24 ); 

t= time ;

g = param( 1 ); 
R = param( 2 ); 
r = param( 3 ); 
L = param( 4 ); 
e = param( 5 ); 
alfa = param( 6 ); 
mP = param( 7 ); 
mxP = param( 8 ); 
myP = param( 9 ); 
mzP = param( 10 ); 
IxxP = param( 11 ); 
IxyP = param( 12 ); 
IyyP = param( 13 ); 
IxzP = param( 14 ); 
IzzP = param( 15 ); 
IyzP = param( 16 ); 
m1 = param( 17 ); 
mx1 = param( 18 ); 
my1 = param( 19 ); 
mz1 = param( 20 ); 
Ixx1 = param( 21 ); 
Ixy1 = param( 22 ); 
Iyy1 = param( 23 ); 
Ixz1 = param( 24 ); 
Izz1 = param( 25 ); 
Iyz1 = param( 26 ); 
m2 = param( 27 ); 
mx2 = param( 28 ); 
my2 = param( 29 ); 
mz2 = param( 30 ); 
Ixx2 = param( 31 ); 
Ixy2 = param( 32 ); 
Iyy2 = param( 33 ); 
Ixz2 = param( 34 ); 
Izz2 = param( 35 ); 
Iyz2 = param( 36 ); 
m3 = param( 37 ); 
mx3 = param( 38 ); 
my3 = param( 39 ); 
mz3 = param( 40 ); 
Ixx3 = param( 41 ); 
Ixy3 = param( 42 ); 
Iyy3 = param( 43 ); 
Ixz3 = param( 44 ); 
Izz3 = param( 45 ); 
Iyz3 = param( 46 ); 
m4 = param( 47 ); 
mx4 = param( 48 ); 
my4 = param( 49 ); 
mz4 = param( 50 ); 
Ixx4 = param( 51 ); 
Ixy4 = param( 52 ); 
Iyy4 = param( 53 ); 
Ixz4 = param( 54 ); 
Izz4 = param( 55 ); 
Iyz4 = param( 56 ); 
m5 = param( 57 ); 
mx5 = param( 58 ); 
my5 = param( 59 ); 
mz5 = param( 60 ); 
Ixx5 = param( 61 ); 
Ixy5 = param( 62 ); 
Iyy5 = param( 63 ); 
Ixz5 = param( 64 ); 
Izz5 = param( 65 ); 
Iyz5 = param( 66 ); 
m6 = param( 67 ); 
mx6 = param( 68 ); 
my6 = param( 69 ); 
mz6 = param( 70 ); 
Ixx6 = param( 71 ); 
Ixy6 = param( 72 ); 
Iyy6 = param( 73 ); 
Ixz6 = param( 74 ); 
Izz6 = param( 75 ); 
Iyz6 = param( 76 ); 
Fs1 = param( 77 ); 
Fs2 = param( 78 ); 
Fs3 = param( 79 ); 
Fs4 = param( 80 ); 
Fs5 = param( 81 ); 
Fs6 = param( 82 ); 
FS001 = param( 83 ); 
FSa11 = param( 84 ); 
FSb11 = param( 85 ); 
FSa21 = param( 86 ); 
FSb21 = param( 87 ); 
FS002 = param( 88 ); 
FSa12 = param( 89 ); 
FSb12 = param( 90 ); 
FSa22 = param( 91 ); 
FSb22 = param( 92 ); 
FS003 = param( 93 ); 
FSa13 = param( 94 ); 
FSb13 = param( 95 ); 
FSa23 = param( 96 ); 
FSb23 = param( 97 ); 
FS004 = param( 98 ); 
FSa14 = param( 99 ); 
FSb14 = param( 100 ); 
FSa24 = param( 101 ); 
FSb24 = param( 102 ); 
FS005 = param( 103 ); 
FSa15 = param( 104 ); 
FSb15 = param( 105 ); 
FSa25 = param( 106 ); 
FSb25 = param( 107 ); 
FS006 = param( 108 ); 
FSa16 = param( 109 ); 
FSb16 = param( 110 ); 
FSa26 = param( 111 ); 
FSb26 = param( 112 ); 

atom39 = cos(c);
atom41 = cos(b);
atom49 = atom39*atom41;
atom40 = sin(c);
atom50 = -atom40*atom41;
atom1372 = atom49*r;
atom1373 = e*atom50;
atom43 = cos(a);
atom42 = sin(b);
atom44 = sin(a);
atom45 = atom42*atom44;
atom56 = atom43*atom39-atom40*atom45;
atom53 = atom43*atom40+atom39*atom45;
atom1376 = e*atom56;
atom1375 = r*atom53;
atom47 = -atom42*atom43;
atom62 = -atom40*atom47+atom39*atom44;
atom59 = atom39*atom47+atom44*atom40;
atom1379 = atom62*e;
atom1378 = atom59*r;
atom0 = 2*alfa;
atom1 = sin(atom0);
atom3 = cos(atom0);
atom2 = -e*atom1;
atom4 = atom3*r;
atom5 = atom2+atom4;
atom7 = r*atom1;
atom6 = atom3*e;
atom8 = atom7+atom6;
atom1396 = atom5*atom49;
atom1397 = atom8*atom50;
atom1408 = atom3*R;
atom1410 = R*atom1;
atom1400 = atom8*atom56;
atom1399 = atom5*atom53;
atom1403 = atom62*atom8;
atom1402 = atom5*atom59;
atom9 = -atom2+atom4;
atom10 = atom7-atom6;
atom1415 = atom49*atom9;
atom1416 = atom10*atom50;
atom1419 = atom10*atom56;
atom1418 = atom9*atom53;
atom1421 = atom59*atom9;
atom1422 = atom10*atom62;
atom213 = (4.0)*alfa;
atom214 = cos(atom213);
atom215 = sin(atom213);
atom1438 = atom214*R;
atom1439 = -e*atom215;
atom1441 = atom215*R;
atom1442 = atom214*e;

Phi_ = [atom1372+x-R+atom1373;
y-e+atom1376+atom1375;
-s1+z+atom1379+atom1378;
atom1372+x-R-atom1373;
y+e-atom1376+atom1375;
z-atom1379+atom1378-s2;
atom1396-atom2-atom1408+x+atom1397;
y-atom1410+atom1400-atom6+atom1399;
atom1403+z+atom1402-s3;
atom2+atom1415-atom1408+x+atom1416;
atom1419+y-atom1410+atom6+atom1418;
z+atom1421-s4+atom1422;
atom1415+x-atom1438-atom1416-atom1439;
-atom1419+y-atom1441+atom1418-atom1442;
z+atom1421-s5-atom1422;
atom1396+x-atom1438-atom1397+atom1439;
y-atom1441-atom1400+atom1442+atom1399;
-atom1403+z+atom1402-s6];

%endfunction

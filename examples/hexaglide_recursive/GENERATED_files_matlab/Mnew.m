function Mnew_ = Mnew(q,time,param)

x = q( 1 ); 
y = q( 2 ); 
z = q( 3 ); 
a = q( 4 ); 
b = q( 5 ); 
c = q( 6 ); 
a1 = q( 7 ); 
a2 = q( 8 ); 
a3 = q( 9 ); 
a4 = q( 10 ); 
a5 = q( 11 ); 
a6 = q( 12 ); 
b1 = q( 13 ); 
b2 = q( 14 ); 
b3 = q( 15 ); 
b4 = q( 16 ); 
b5 = q( 17 ); 
b6 = q( 18 ); 
s1 = q( 19 ); 
s2 = q( 20 ); 
s3 = q( 21 ); 
s4 = q( 22 ); 
s5 = q( 23 ); 
s6 = q( 24 ); 

t= time ;

g = param( 1 ); 
R = param( 2 ); 
r = param( 3 ); 
L = param( 4 ); 
e = param( 5 ); 
mP = param( 6 ); 
mxP = param( 7 ); 
myP = param( 8 ); 
mzP = param( 9 ); 
IxxP = param( 10 ); 
IxyP = param( 11 ); 
IyyP = param( 12 ); 
IxzP = param( 13 ); 
IzzP = param( 14 ); 
IyzP = param( 15 ); 
m1 = param( 16 ); 
mx1 = param( 17 ); 
my1 = param( 18 ); 
mz1 = param( 19 ); 
Ixx1 = param( 20 ); 
Ixy1 = param( 21 ); 
Iyy1 = param( 22 ); 
Ixz1 = param( 23 ); 
Izz1 = param( 24 ); 
Iyz1 = param( 25 ); 
m2 = param( 26 ); 
mx2 = param( 27 ); 
my2 = param( 28 ); 
mz2 = param( 29 ); 
Ixx2 = param( 30 ); 
Ixy2 = param( 31 ); 
Iyy2 = param( 32 ); 
Ixz2 = param( 33 ); 
Izz2 = param( 34 ); 
Iyz2 = param( 35 ); 
m3 = param( 36 ); 
mx3 = param( 37 ); 
my3 = param( 38 ); 
mz3 = param( 39 ); 
Ixx3 = param( 40 ); 
Ixy3 = param( 41 ); 
Iyy3 = param( 42 ); 
Ixz3 = param( 43 ); 
Izz3 = param( 44 ); 
Iyz3 = param( 45 ); 
m4 = param( 46 ); 
mx4 = param( 47 ); 
my4 = param( 48 ); 
mz4 = param( 49 ); 
Ixx4 = param( 50 ); 
Ixy4 = param( 51 ); 
Iyy4 = param( 52 ); 
Ixz4 = param( 53 ); 
Izz4 = param( 54 ); 
Iyz4 = param( 55 ); 
m5 = param( 56 ); 
mx5 = param( 57 ); 
my5 = param( 58 ); 
mz5 = param( 59 ); 
Ixx5 = param( 60 ); 
Ixy5 = param( 61 ); 
Iyy5 = param( 62 ); 
Ixz5 = param( 63 ); 
Izz5 = param( 64 ); 
Iyz5 = param( 65 ); 
m6 = param( 66 ); 
mx6 = param( 67 ); 
my6 = param( 68 ); 
mz6 = param( 69 ); 
Ixx6 = param( 70 ); 
Ixy6 = param( 71 ); 
Iyy6 = param( 72 ); 
Ixz6 = param( 73 ); 
Izz6 = param( 74 ); 
Iyz6 = param( 75 ); 
Fs1 = param( 76 ); 
Fs2 = param( 77 ); 
Fs3 = param( 78 ); 
Fs4 = param( 79 ); 
Fs5 = param( 80 ); 
Fs6 = param( 81 ); 
FS001 = param( 82 ); 
FSa11 = param( 83 ); 
FSb11 = param( 84 ); 
FSa21 = param( 85 ); 
FSb21 = param( 86 ); 
FS002 = param( 87 ); 
FSa12 = param( 88 ); 
FSb12 = param( 89 ); 
FSa22 = param( 90 ); 
FSb22 = param( 91 ); 
FS003 = param( 92 ); 
FSa13 = param( 93 ); 
FSb13 = param( 94 ); 
FSa23 = param( 95 ); 
FSb23 = param( 96 ); 
FS004 = param( 97 ); 
FSa14 = param( 98 ); 
FSb14 = param( 99 ); 
FSa24 = param( 100 ); 
FSb24 = param( 101 ); 
FS005 = param( 102 ); 
FSa15 = param( 103 ); 
FSb15 = param( 104 ); 
FSa25 = param( 105 ); 
FSb25 = param( 106 ); 
FS006 = param( 107 ); 
FSa16 = param( 108 ); 
FSb16 = param( 109 ); 
FSa26 = param( 110 ); 
FSb26 = param( 111 ); 
gra = param( 112 ); 

atom38 = sin(c);
atom39 = cos(b);
atom37 = cos(c);
atom47 = atom37*atom39;
atom40 = sin(b);
atom48 = -atom38*atom39;
atom3787 = mzP*atom47-atom40*mxP;
atom3784 = -mzP*atom48+atom40*myP;
atom3790 = -atom47*myP+mxP*atom48;
atom5934 = -mzP*atom38;
atom5932 = mzP*atom37;
atom5939 = -atom37*mxP+atom38*myP;
atom42 = sin(a);
atom44 = -atom42*atom39;
atom41 = cos(a);
atom43 = atom40*atom42;
atom51 = atom41*atom38+atom37*atom43;
atom54 = -atom38*atom43+atom37*atom41;
atom45 = -atom40*atom41;
atom57 = atom37*atom45+atom42*atom38;
atom60 = -atom38*atom45+atom37*atom42;
atom46 = atom41*atom39;
atom3763 = IxzP*atom38;
atom3760 = atom37*IxyP+IxxP*atom38;
atom3762 = atom37*IyyP+atom38*IxyP;
atom307 = atom47*IxzP;
atom305 = atom40*IzzP;
atom80 = sin(b1);
atom79 = cos(b1);
atom838 = atom80*Izz1;
atom81 = cos(a1);
atom86 = atom79*atom81;
atom82 = sin(a1);
atom85 = -atom80*atom81;
atom104 = sin(b2);
atom103 = cos(b2);
atom1132 = atom104*Izz2;
atom106 = sin(a2);
atom105 = cos(a2);
atom109 = -atom104*atom105;
atom110 = atom103*atom105;
atom128 = sin(b3);
atom127 = cos(b3);
atom1433 = Izz3*atom128;
atom130 = sin(a3);
atom129 = cos(a3);
atom148 = -atom128*atom129;
atom149 = atom127*atom129;
atom169 = sin(b4);
atom168 = cos(b4);
atom1751 = Izz4*atom169;
atom171 = sin(a4);
atom170 = cos(a4);
atom188 = -atom169*atom170;
atom189 = atom168*atom170;
atom209 = sin(b5);
atom208 = cos(b5);
atom2067 = atom209*Izz5;
atom211 = sin(a5);
atom210 = cos(a5);
atom229 = atom208*atom210;
atom228 = -atom209*atom210;
atom249 = sin(b6);
atom248 = cos(b6);
atom2383 = atom249*Izz6;
atom250 = cos(a6);
atom269 = atom250*atom248;
atom251 = sin(a6);
atom268 = -atom249*atom250;
atom5931 = -atom47*atom3784-atom48*atom3787-atom3790*atom40;
atom5941 = atom47*atom5932+atom40*atom5939+atom5934*atom48;
atom5946 = -atom3790*atom44-atom3787*atom54-atom3784*atom51;
atom5951 = atom5932*atom51+atom44*atom5939+atom5934*atom54;
atom3799 = mxP*atom54-myP*atom51;
atom5956 = -atom60*atom3787-atom57*atom3784-atom3790*atom46;
atom5961 = atom57*atom5932+atom60*atom5934+atom5939*atom46;
atom3808 = atom60*mxP-atom57*myP;
atom5969 = atom3760*atom47+atom3762*atom48+atom40*(atom3763+atom37*IzzP);
atom310 = atom48*IyzP+atom305+atom307;
atom3765 = atom3763+atom37*IyzP;
atom839 = atom838+atom79*Ixy1;
atom4019 = atom80*(mx1*atom82-atom85*my1)+atom79*(atom86*my1-mz1*atom82);
atom1133 = atom103*Ixy2+atom1132;
atom4119 = atom104*(mx2*atom106-atom109*my2)+atom103*(atom110*my2-mz2*atom106);
atom1434 = atom1433+Ixy3*atom127;
atom4219 = -atom127*(atom130*mz3-my3*atom149)+(atom130*mx3-atom148*my3)*atom128;
atom1752 = atom168*Ixy4+atom1751;
atom4333 = atom168*(my4*atom189-mz4*atom171)-atom169*(atom188*my4-mx4*atom171);
atom2068 = atom2067+atom208*Ixy5;
atom4447 = -atom208*(atom211*mz5-atom229*my5)-(atom228*my5-mx5*atom211)*atom209;
atom2384 = Ixy6*atom248+atom2383;
atom4561 = -(atom251*mz6-atom269*my6)*atom248+(atom251*mx6-atom268*my6)*atom249;
atom4013 = -atom86*mx1+mz1*atom85;
atom4113 = mz2*atom109-atom110*mx2;
atom4213 = atom148*mz3-mx3*atom149;
atom4327 = -mx4*atom189+atom188*mz4;
atom4441 = -mx5*atom229+atom228*mz5;
atom4555 = -atom269*mx6+atom268*mz6;

Mnew_ = [mP , 0.0 , 0.0 , atom5931 , atom5941 , atom3790 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0;
0.0 , mP , 0.0 , atom5946 , atom5951 , atom3799 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0;
0.0 , 0.0 , mP , atom5956 , atom5961 , atom3808 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0;
atom5931 , atom5946 , atom5956 , atom47*(atom40*IxzP+atom47*IxxP+IxyP*atom48)+atom40*(IzzP*atom48+atom305+atom307)+(atom48*IyyP+atom40*IyzP+atom47*IxyP)*atom48 , atom5969 , atom310 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0;
atom5941 , atom5951 , atom5961 , atom5969 , atom37*atom3762+atom3760*atom38 , atom3765 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0;
atom3790 , atom3799 , atom3808 , atom310 , atom3765 , IzzP , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0;
0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , atom79*(Ixz1*atom80+atom79*Ixx1)+atom80*(atom838+atom79*Ixz1) , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , atom839 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , atom4019 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0;
0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , atom103*(atom103*Ixx2+atom104*Ixz2)+(atom103*Ixz2+atom1132)*atom104 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , atom1133 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , atom4119 , 0.0 , 0.0 , 0.0 , 0.0;
0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , (atom128*Ixz3+atom127*Ixx3)*atom127+atom128*(atom1433+atom127*Ixz3) , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , atom1434 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , atom4219 , 0.0 , 0.0 , 0.0;
0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , atom169*(atom1751+atom168*Ixz4)+atom168*(atom168*Ixx4+atom169*Ixz4) , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , atom1752 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , atom4333 , 0.0 , 0.0;
0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , atom209*(atom2067+atom208*Ixz5)+atom208*(atom209*Ixz5+atom208*Ixx5) , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , atom2068 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , atom4447 , 0.0;
0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , (atom249*Ixz6+atom248*Ixx6)*atom248+atom249*(Ixz6*atom248+atom2383) , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , atom2384 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , atom4561;
0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , atom839 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , Iyy1 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , atom4013 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0;
0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , atom1133 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , Iyy2 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , atom4113 , 0.0 , 0.0 , 0.0 , 0.0;
0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , atom1434 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , Iyy3 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , atom4213 , 0.0 , 0.0 , 0.0;
0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , atom1752 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , Iyy4 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , atom4327 , 0.0 , 0.0;
0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , atom2068 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , Iyy5 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , atom4441 , 0.0;
0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , atom2384 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , Iyy6 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , atom4555;
0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , atom4019 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , atom4013 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0;
0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , atom4119 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , atom4113 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0;
0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , atom4219 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , atom4213 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0;
0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , atom4333 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , atom4327 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0;
0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , atom4447 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , atom4441 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0;
0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , atom4561 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , atom4555 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , m6];

%endfunction

function NolinPhi_ = NolinPhi(q,dq,ddq)

global t;
global g;
global R;
global r;
global L;
global e;
global mP;
global mxP;
global myP;
global mzP;
global IxxP;
global IxyP;
global IyyP;
global IxzP;
global IzzP;
global IyzP;
global m1;
global mx1;
global my1;
global mz1;
global Ixx1;
global Ixy1;
global Iyy1;
global Ixz1;
global Izz1;
global Iyz1;
global m2;
global mx2;
global my2;
global mz2;
global Ixx2;
global Ixy2;
global Iyy2;
global Ixz2;
global Izz2;
global Iyz2;
global m3;
global mx3;
global my3;
global mz3;
global Ixx3;
global Ixy3;
global Iyy3;
global Ixz3;
global Izz3;
global Iyz3;
global m4;
global mx4;
global my4;
global mz4;
global Ixx4;
global Ixy4;
global Iyy4;
global Ixz4;
global Izz4;
global Iyz4;
global m5;
global mx5;
global my5;
global mz5;
global Ixx5;
global Ixy5;
global Iyy5;
global Ixz5;
global Izz5;
global Iyz5;
global m6;
global mx6;
global my6;
global mz6;
global Ixx6;
global Ixy6;
global Iyy6;
global Ixz6;
global Izz6;
global Iyz6;
global Fs1;
global Fs2;
global Fs3;
global Fs4;
global Fs5;
global Fs6;
global FS001;
global FSa11;
global FSb11;
global FSa21;
global FSb21;
global FS002;
global FSa12;
global FSb12;
global FSa22;
global FSb22;
global FS003;
global FSa13;
global FSb13;
global FSa23;
global FSb23;
global FS004;
global FSa14;
global FSb14;
global FSa24;
global FSb24;
global FS005;
global FSa15;
global FSb15;
global FSa25;
global FSb25;
global FS006;
global FSa16;
global FSb16;
global FSa26;
global FSb26;
global x;
global y;
global z;
global a;
global b;
global c;
global a1;
global a2;
global a3;
global a4;
global a5;
global a6;
global b1;
global b2;
global b3;
global b4;
global b5;
global b6;
global s1;
global s2;
global s3;
global s4;
global s5;
global s6;
global dx;
global dy;
global dz;
global da;
global dB;
global dc;
global da1;
global da2;
global da3;
global da4;
global da5;
global da6;
global dB1;
global dB2;
global dB3;
global dB4;
global dB5;
global dB6;
global ds1;
global ds2;
global ds3;
global ds4;
global ds5;
global ds6;
if nargin == 3
global ddx;
global ddy;
global ddz;
global dda;
global ddB;
global ddc;
global dda1;
global dda2;
global dda3;
global dda4;
global dda5;
global dda6;
global ddB1;
global ddB2;
global ddB3;
global ddB4;
global ddB5;
global ddB6;
global dds1;
global dds2;
global dds3;
global dds4;
global dds5;
global dds6;
end
global lambda1;
global lambda2;
global lambda3;
global lambda4;
global lambda5;
global lambda6;
global lambda7;
global lambda8;
global lambda9;
global lambda10;
global lambda11;
global lambda12;
global lambda13;
global lambda14;
global lambda15;
global lambda16;
global lambda17;
global lambda18;

x = q( 1); 
y = q( 2); 
z = q( 3); 
a = q( 4); 
b = q( 5); 
c = q( 6); 
a1 = q( 7); 
a2 = q( 8); 
a3 = q( 9); 
a4 = q( 10); 
a5 = q( 11); 
a6 = q( 12); 
b1 = q( 13); 
b2 = q( 14); 
b3 = q( 15); 
b4 = q( 16); 
b5 = q( 17); 
b6 = q( 18); 
s1 = q( 19); 
s2 = q( 20); 
s3 = q( 21); 
s4 = q( 22); 
s5 = q( 23); 
s6 = q( 24); 
dx = dq( 1); 
dy = dq( 2); 
dz = dq( 3); 
da = dq( 4); 
dB = dq( 5); 
dc = dq( 6); 
da1 = dq( 7); 
da2 = dq( 8); 
da3 = dq( 9); 
da4 = dq( 10); 
da5 = dq( 11); 
da6 = dq( 12); 
dB1 = dq( 13); 
dB2 = dq( 14); 
dB3 = dq( 15); 
dB4 = dq( 16); 
dB5 = dq( 17); 
dB6 = dq( 18); 
ds1 = dq( 19); 
ds2 = dq( 20); 
ds3 = dq( 21); 
ds4 = dq( 22); 
ds5 = dq( 23); 
ds6 = dq( 24); 
if nargin == 3
ddx = ddq( 1); 
ddy = ddq( 2); 
ddz = ddq( 3); 
dda = ddq( 4); 
ddB = ddq( 5); 
ddc = ddq( 6); 
dda1 = ddq( 7); 
dda2 = ddq( 8); 
dda3 = ddq( 9); 
dda4 = ddq( 10); 
dda5 = ddq( 11); 
dda6 = ddq( 12); 
ddB1 = ddq( 13); 
ddB2 = ddq( 14); 
ddB3 = ddq( 15); 
ddB4 = ddq( 16); 
ddB5 = ddq( 17); 
ddB6 = ddq( 18); 
dds1 = ddq( 19); 
dds2 = ddq( 20); 
dds3 = ddq( 21); 
dds4 = ddq( 22); 
dds5 = ddq( 23); 
dds6 = ddq( 24); 
end

atom79 = cos(b1);
atom39 = cos(b);
atom46 = cos(a)*atom39;
atom44 = -sin(a)*atom39;
atom40 = sin(b);
atom103 = cos(b2);
atom127 = cos(b3);
atom128 = sin(b3);
atom130 = sin(a3);
atom131 = 1/2*sqrt(3);
atom168 = cos(b4);
atom169 = sin(b4);
atom171 = sin(a4);
atom208 = cos(b5);
atom211 = sin(a5);
atom209 = sin(b5);
atom248 = cos(b6);
atom249 = sin(b6);
atom251 = sin(a6);

NolinPhi_ = [atom40*sin(b1)-atom79*atom44*sin(a1)+atom79*atom46*cos(a1);
atom103*atom46*cos(a2)+atom40*sin(b2)-atom103*atom44*sin(a2);
1/2*atom44*(atom130*atom127+2*atom131*atom128)+atom127*atom46*cos(a3)+1/2*atom40*(2*atom130*atom131*atom127-atom128);
1/2*atom44*(2*atom131*atom169+atom168*atom171)+atom168*atom46*cos(a4)+1/2*atom40*(2*atom168*atom131*atom171-atom169);
-1/2*atom44*(2*atom131*atom209-atom208*atom211)-1/2*atom40*(atom209+2*atom208*atom131*atom211)+atom208*atom46*cos(a5);
-1/2*atom44*(2*atom249*atom131-atom251*atom248)+atom46*atom248*cos(a6)-1/2*atom40*(atom249+2*atom131*atom251*atom248)];

%endfunction

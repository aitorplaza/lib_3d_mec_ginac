function WPhinew_ = WPhinew(q,dq,ddq,unknowns,time,param,inputs)

x = q( 1 ); 
y = q( 2 ); 
z = q( 3 ); 
a = q( 4 ); 
b = q( 5 ); 
c = q( 6 ); 
a1 = q( 7 ); 
a2 = q( 8 ); 
a3 = q( 9 ); 
a4 = q( 10 ); 
a5 = q( 11 ); 
a6 = q( 12 ); 
b1 = q( 13 ); 
b2 = q( 14 ); 
b3 = q( 15 ); 
b4 = q( 16 ); 
b5 = q( 17 ); 
b6 = q( 18 ); 
s1 = q( 19 ); 
s2 = q( 20 ); 
s3 = q( 21 ); 
s4 = q( 22 ); 
s5 = q( 23 ); 
s6 = q( 24 ); 

dx = dq( 1 ); 
dy = dq( 2 ); 
dz = dq( 3 ); 
da = dq( 4 ); 
dB = dq( 5 ); 
dc = dq( 6 ); 
da1 = dq( 7 ); 
da2 = dq( 8 ); 
da3 = dq( 9 ); 
da4 = dq( 10 ); 
da5 = dq( 11 ); 
da6 = dq( 12 ); 
dB1 = dq( 13 ); 
dB2 = dq( 14 ); 
dB3 = dq( 15 ); 
dB4 = dq( 16 ); 
dB5 = dq( 17 ); 
dB6 = dq( 18 ); 
ds1 = dq( 19 ); 
ds2 = dq( 20 ); 
ds3 = dq( 21 ); 
ds4 = dq( 22 ); 
ds5 = dq( 23 ); 
ds6 = dq( 24 ); 

ddx = ddq( 1 ); 
ddy = ddq( 2 ); 
ddz = ddq( 3 ); 
dda = ddq( 4 ); 
ddB = ddq( 5 ); 
ddc = ddq( 6 ); 
dda1 = ddq( 7 ); 
dda2 = ddq( 8 ); 
dda3 = ddq( 9 ); 
dda4 = ddq( 10 ); 
dda5 = ddq( 11 ); 
dda6 = ddq( 12 ); 
ddB1 = ddq( 13 ); 
ddB2 = ddq( 14 ); 
ddB3 = ddq( 15 ); 
ddB4 = ddq( 16 ); 
ddB5 = ddq( 17 ); 
ddB6 = ddq( 18 ); 
dds1 = ddq( 19 ); 
dds2 = ddq( 20 ); 
dds3 = ddq( 21 ); 
dds4 = ddq( 22 ); 
dds5 = ddq( 23 ); 
dds6 = ddq( 24 ); 

lambda1 = unknowns( 1 ); 
lambda2 = unknowns( 2 ); 
lambda3 = unknowns( 3 ); 
lambda4 = unknowns( 4 ); 
lambda5 = unknowns( 5 ); 
lambda6 = unknowns( 6 ); 
lambda7 = unknowns( 7 ); 
lambda8 = unknowns( 8 ); 
lambda9 = unknowns( 9 ); 
lambda10 = unknowns( 10 ); 
lambda11 = unknowns( 11 ); 
lambda12 = unknowns( 12 ); 
lambda13 = unknowns( 13 ); 
lambda14 = unknowns( 14 ); 
lambda15 = unknowns( 15 ); 
lambda16 = unknowns( 16 ); 
lambda17 = unknowns( 17 ); 
lambda18 = unknowns( 18 ); 

t= time ;

g = param( 1 ); 
R = param( 2 ); 
r = param( 3 ); 
L = param( 4 ); 
e = param( 5 ); 
mP = param( 6 ); 
mxP = param( 7 ); 
myP = param( 8 ); 
mzP = param( 9 ); 
IxxP = param( 10 ); 
IxyP = param( 11 ); 
IyyP = param( 12 ); 
IxzP = param( 13 ); 
IzzP = param( 14 ); 
IyzP = param( 15 ); 
m1 = param( 16 ); 
mx1 = param( 17 ); 
my1 = param( 18 ); 
mz1 = param( 19 ); 
Ixx1 = param( 20 ); 
Ixy1 = param( 21 ); 
Iyy1 = param( 22 ); 
Ixz1 = param( 23 ); 
Izz1 = param( 24 ); 
Iyz1 = param( 25 ); 
m2 = param( 26 ); 
mx2 = param( 27 ); 
my2 = param( 28 ); 
mz2 = param( 29 ); 
Ixx2 = param( 30 ); 
Ixy2 = param( 31 ); 
Iyy2 = param( 32 ); 
Ixz2 = param( 33 ); 
Izz2 = param( 34 ); 
Iyz2 = param( 35 ); 
m3 = param( 36 ); 
mx3 = param( 37 ); 
my3 = param( 38 ); 
mz3 = param( 39 ); 
Ixx3 = param( 40 ); 
Ixy3 = param( 41 ); 
Iyy3 = param( 42 ); 
Ixz3 = param( 43 ); 
Izz3 = param( 44 ); 
Iyz3 = param( 45 ); 
m4 = param( 46 ); 
mx4 = param( 47 ); 
my4 = param( 48 ); 
mz4 = param( 49 ); 
Ixx4 = param( 50 ); 
Ixy4 = param( 51 ); 
Iyy4 = param( 52 ); 
Ixz4 = param( 53 ); 
Izz4 = param( 54 ); 
Iyz4 = param( 55 ); 
m5 = param( 56 ); 
mx5 = param( 57 ); 
my5 = param( 58 ); 
mz5 = param( 59 ); 
Ixx5 = param( 60 ); 
Ixy5 = param( 61 ); 
Iyy5 = param( 62 ); 
Ixz5 = param( 63 ); 
Izz5 = param( 64 ); 
Iyz5 = param( 65 ); 
m6 = param( 66 ); 
mx6 = param( 67 ); 
my6 = param( 68 ); 
mz6 = param( 69 ); 
Ixx6 = param( 70 ); 
Ixy6 = param( 71 ); 
Iyy6 = param( 72 ); 
Ixz6 = param( 73 ); 
Izz6 = param( 74 ); 
Iyz6 = param( 75 ); 
Fs1 = param( 76 ); 
Fs2 = param( 77 ); 
Fs3 = param( 78 ); 
Fs4 = param( 79 ); 
Fs5 = param( 80 ); 
Fs6 = param( 81 ); 
FS001 = param( 82 ); 
FSa11 = param( 83 ); 
FSb11 = param( 84 ); 
FSa21 = param( 85 ); 
FSb21 = param( 86 ); 
FS002 = param( 87 ); 
FSa12 = param( 88 ); 
FSb12 = param( 89 ); 
FSa22 = param( 90 ); 
FSb22 = param( 91 ); 
FS003 = param( 92 ); 
FSa13 = param( 93 ); 
FSb13 = param( 94 ); 
FSa23 = param( 95 ); 
FSb23 = param( 96 ); 
FS004 = param( 97 ); 
FSa14 = param( 98 ); 
FSb14 = param( 99 ); 
FSa24 = param( 100 ); 
FSb24 = param( 101 ); 
FS005 = param( 102 ); 
FSa15 = param( 103 ); 
FSb15 = param( 104 ); 
FSa25 = param( 105 ); 
FSb25 = param( 106 ); 
FS006 = param( 107 ); 
FSa16 = param( 108 ); 
FSb16 = param( 109 ); 
FSa26 = param( 110 ); 
FSb26 = param( 111 ); 
gra = param( 112 ); 


atom37 = cos(c);
atom39 = cos(b);
atom38 = sin(c);
atom3747 = atom39*da;
atom40 = sin(b);
atom3748 = atom40*da;
atom4730 = atom38*dB+atom3747*atom37;
atom3749 = atom3748+dc;
atom4726 = -atom3748*dB+dda*atom39;
atom4749 = atom4730*atom3749;
atom4744 = atom37*ddB-atom4730*dc-atom38*atom4726;
atom4733 = atom37*dB-atom3747*atom38;
atom4745 = atom3749^2;
atom4746 = atom4733^2;
atom4742 = atom3747*dB+ddc+atom40*dda;
atom4748 = atom4730*atom4733;
atom47 = atom37*atom39;
atom4765 = mzP*(atom4749+atom4744)-myP*(atom4742-atom4748)-mxP*(atom4745+atom4746);
atom4750 = atom4730^2;
atom4752 = atom3749*atom4733;
atom4743 = ddB*atom38+atom37*atom4726+dc*atom4733;
atom4770 = -(atom4745+atom4750)*myP+(atom4742+atom4748)*mxP+mzP*(atom4752-atom4743);
atom48 = -atom38*atom39;
atom4775 = (atom4752+atom4743)*myP+(atom4749-atom4744)*mxP-mzP*(atom4746+atom4750);
atom42 = sin(a);
atom44 = -atom42*atom39;
atom41 = cos(a);
atom43 = atom40*atom42;
atom54 = -atom38*atom43+atom37*atom41;
atom51 = atom41*atom38+atom37*atom43;
atom4760 = ddz+gra;
atom46 = atom41*atom39;
atom45 = -atom40*atom41;
atom60 = -atom38*atom45+atom37*atom42;
atom57 = atom37*atom45+atom42*atom38;
atom4809 = atom4760*atom46+atom40*ddx+atom44*ddy;
atom4804 = ddx*atom48+ddy*atom54+atom60*atom4760;
atom4844 = -atom37*atom3748;
atom4846 = atom3748*atom38;
atom4824 = atom4730*IxyP;
atom4833 = IzzP*atom4733+atom3749*IzzP+atom4730*IxzP;
atom4828 = atom4824+atom3749*IyzP+IyyP*atom4733;
atom4892 = -(atom4824-IxxP*atom4733)*dc+atom4809*myP+dda*(atom40*IxzP+atom47*IxxP+IxyP*atom48)-atom3749*atom4828+dB*(atom3747*IxzP+IxxP*atom4844+IxyP*atom4846)+atom4833*atom4733+(atom37*IxyP+IxxP*atom38)*ddB-mzP*atom4804+ddc*IxzP;
atom4820 = IxyP*atom4733;
atom4823 = atom4730*IxxP+atom3749*IxzP+atom4820;
atom4799 = atom47*ddx+ddy*atom51+atom57*atom4760;
atom4893 = -atom4730*atom4833+atom3749*atom4823+mzP*atom4799-atom4809*mxP+ddc*IyzP-(atom4730*IyyP-atom4820)*dc+(atom48*IyyP+atom40*IyzP+atom47*IxyP)*dda+ddB*(atom37*IyyP+atom38*IxyP)+(atom3747*IyzP+atom4846*IyyP+atom4844*IxyP)*dB;
atom4894 = -atom4799*myP+dda*(IzzP*atom48+atom47*IxzP+atom40*IzzP)+ddc*IzzP-atom4823*atom4733+(IzzP*atom4846+IxzP*atom4844+atom3747*IzzP)*dB+mxP*atom4804+atom4730*atom4828+ddB*(atom37*IzzP+IxzP*atom38)+(IxzP*atom4733-atom4730*IzzP)*dc;
atom80 = sin(b1);
atom79 = cos(b1);
atom4936 = atom79*da1;
atom4030 = atom80*da1;
atom4994 = atom4030*Ixz1;
atom4995 = Ixx1*atom4936+dB1*Ixy1+atom4994;
atom5000 = atom4936*Ixy1+atom4030*Iyz1+Iyy1*dB1;
atom4956 = dds1+gra;
atom82 = sin(a1);
atom4980 = atom4956*atom82;
atom81 = cos(a1);
atom85 = -atom80*atom81;
atom4979 = atom85*atom4956;
atom5001 = Ixz1*atom4936;
atom5005 = atom5001+dB1*Izz1+atom4030*Izz1;
atom86 = atom79*atom81;
atom4981 = atom86*atom4956;
atom5072 = dds2+gra;
atom106 = sin(a2);
atom5096 = atom5072*atom106;
atom103 = cos(b2);
atom105 = cos(a2);
atom110 = atom103*atom105;
atom5097 = atom110*atom5072;
atom104 = sin(b2);
atom5052 = atom103*da2;
atom4130 = atom104*da2;
atom5117 = atom5052*Ixz2;
atom5121 = atom5117+atom4130*Izz2+dB2*Izz2;
atom5116 = atom5052*Ixy2+Iyz2*atom4130+Iyy2*dB2;
atom5110 = atom4130*Ixz2;
atom5111 = atom5110+dB2*Ixy2+Ixx2*atom5052;
atom109 = -atom104*atom105;
atom5095 = atom109*atom5072;
atom127 = cos(b3);
atom129 = cos(a3);
atom149 = atom127*atom129;
atom5188 = dds3+gra;
atom5213 = atom149*atom5188;
atom130 = sin(a3);
atom5212 = atom130*atom5188;
atom128 = sin(b3);
atom4244 = atom128*da3;
atom5168 = atom127*da3;
atom5233 = atom5168*Ixz3;
atom5237 = Izz3*dB3+Izz3*atom4244+atom5233;
atom5232 = atom4244*Iyz3+dB3*Iyy3+atom5168*Ixy3;
atom5226 = atom4244*Ixz3;
atom5227 = atom5168*Ixx3+Ixy3*dB3+atom5226;
atom148 = -atom128*atom129;
atom5211 = atom148*atom5188;
atom168 = cos(b4);
atom170 = cos(a4);
atom5304 = gra+dds4;
atom189 = atom168*atom170;
atom5329 = atom5304*atom189;
atom171 = sin(a4);
atom5328 = atom5304*atom171;
atom169 = sin(b4);
atom5284 = atom168*da4;
atom4358 = atom169*da4;
atom5349 = atom5284*Ixz4;
atom5353 = Izz4*atom4358+atom5349+Izz4*dB4;
atom5348 = Ixy4*atom5284+dB4*Iyy4+atom4358*Iyz4;
atom188 = -atom169*atom170;
atom5327 = atom188*atom5304;
atom5342 = atom4358*Ixz4;
atom5343 = atom5284*Ixx4+atom5342+Ixy4*dB4;
atom209 = sin(b5);
atom4472 = atom209*da5;
atom208 = cos(b5);
atom5400 = atom208*da5;
atom5458 = atom4472*Ixz5;
atom5459 = atom5458+Ixx5*atom5400+dB5*Ixy5;
atom5464 = Ixy5*atom5400+atom4472*Iyz5+dB5*Iyy5;
atom211 = sin(a5);
atom5420 = gra+dds5;
atom5444 = atom211*atom5420;
atom210 = cos(a5);
atom228 = -atom209*atom210;
atom5443 = atom228*atom5420;
atom229 = atom208*atom210;
atom5445 = atom229*atom5420;
atom5465 = atom5400*Ixz5;
atom5469 = atom5465+atom4472*Izz5+dB5*Izz5;
atom249 = sin(b6);
atom248 = cos(b6);
atom5516 = da6*atom248;
atom4586 = atom249*da6;
atom5581 = atom5516*Ixz6;
atom5580 = atom5516*Ixy6+dB6*Iyy6+atom4586*Iyz6;
atom5585 = Izz6*dB6+atom5581+Izz6*atom4586;
atom5536 = gra+dds6;
atom251 = sin(a6);
atom5560 = atom5536*atom251;
atom250 = cos(a6);
atom269 = atom250*atom248;
atom5561 = atom269*atom5536;
atom5574 = atom4586*Ixz6;
atom5575 = dB6*Ixy6+atom5574+atom5516*Ixx6;
atom268 = -atom249*atom250;
atom5559 = atom268*atom5536;
atom4944 = dB1^2;
atom4947 = atom4936^2;
atom4937 = atom4030*dB1;
atom4941 = -atom4937+dda1*atom79;
atom4946 = atom4030*atom4936;
atom4938 = dB1*atom4936;
atom4942 = dda1*atom80+atom4938;
atom4943 = atom4030^2;
atom5063 = atom5052^2;
atom5060 = dB2^2;
atom5053 = dB2*atom4130;
atom5057 = -atom5053+atom103*dda2;
atom5062 = atom5052*atom4130;
atom5054 = dB2*atom5052;
atom5058 = atom104*dda2+atom5054;
atom5059 = atom4130^2;
atom5170 = atom5168*dB3;
atom5174 = dda3*atom128+atom5170;
atom5175 = atom4244^2;
atom5176 = dB3^2;
atom5178 = atom5168*atom4244;
atom5169 = atom4244*dB3;
atom5173 = -atom5169+dda3*atom127;
atom5179 = atom5168^2;
atom5286 = atom5284*dB4;
atom5290 = dda4*atom169+atom5286;
atom5291 = atom4358^2;
atom5295 = atom5284^2;
atom5285 = dB4*atom4358;
atom5289 = dda4*atom168-atom5285;
atom5294 = atom5284*atom4358;
atom5292 = dB4^2;
atom5408 = dB5^2;
atom5407 = atom4472^2;
atom5402 = dB5*atom5400;
atom5406 = atom209*dda5+atom5402;
atom5410 = atom4472*atom5400;
atom5411 = atom5400^2;
atom5401 = atom4472*dB5;
atom5405 = atom208*dda5-atom5401;
atom5526 = atom5516*atom4586;
atom5518 = atom5516*dB6;
atom5522 = atom5518+atom249*dda6;
atom5523 = atom4586^2;
atom5524 = dB6^2;
atom5517 = dB6*atom4586;
atom5521 = atom248*dda6-atom5517;
atom5527 = atom5516^2;

WPhinew_ = [atom4770*atom48+atom40*atom4775+mP*ddx+atom47*atom4765;
atom44*atom4775+atom4770*atom54+mP*ddy+atom4765*atom51;
atom4770*atom60+atom46*atom4775+atom57*atom4765+mP*atom4760;
atom4893*atom48+atom47*atom4892+atom40*atom4894;
atom4893*atom37+atom4892*atom38;
atom4894;
(atom5005*dB1+Ixy1*ddB1+dB1*(atom5001-atom4030*Ixx1)-mz1*atom4980-atom4030*atom5000+atom4981*my1+dda1*(Ixz1*atom80+atom79*Ixx1))*atom79-atom80*(atom4995*dB1-atom5000*atom4936+my1*atom4979+(atom4994-atom4936*Izz1)*dB1-dda1*(atom80*Izz1+atom79*Ixz1)-atom4980*mx1-Izz1*ddB1);
-(atom5111*dB2-ddB2*Izz2+atom5095*my2-(atom5052*Izz2-atom5110)*dB2-atom5052*atom5116-(atom104*Izz2+atom103*Ixz2)*dda2-atom5096*mx2)*atom104+atom103*((atom103*Ixx2+atom104*Ixz2)*dda2+ddB2*Ixy2+atom5121*dB2+atom5097*my2-mz2*atom5096+dB2*(atom5117-Ixx2*atom4130)-atom4130*atom5116);
atom127*(Ixy3*ddB3-atom4244*atom5232-mz3*atom5212-dB3*(atom4244*Ixx3-atom5233)+dB3*atom5237+my3*atom5213+(atom128*Ixz3+atom127*Ixx3)*dda3)+atom128*(atom5168*atom5232+atom5212*mx3-dB3*atom5227+dB3*(atom5168*Izz3-atom5226)-my3*atom5211+Izz3*ddB3+dda3*(atom127*Ixz3+Izz3*atom128));
atom168*(atom5329*my4+dda4*(atom168*Ixx4+atom169*Ixz4)+Ixy4*ddB4-atom4358*atom5348+atom5353*dB4-dB4*(atom4358*Ixx4-atom5349)-mz4*atom5328)-(dB4*atom5343-dda4*(Izz4*atom169+atom168*Ixz4)-mx4*atom5328-Izz4*ddB4+dB4*(atom5342-Izz4*atom5284)+atom5327*my4-atom5284*atom5348)*atom169;
-atom209*(my5*atom5443+dB5*atom5459-atom5464*atom5400-(atom208*Ixz5+atom209*Izz5)*dda5+dB5*(atom5458-Izz5*atom5400)-Izz5*ddB5-mx5*atom5444)+atom208*((atom209*Ixz5+atom208*Ixx5)*dda5+dB5*(atom5465-atom4472*Ixx5)+my5*atom5445-atom5444*mz5+dB5*atom5469+Ixy5*ddB5-atom4472*atom5464);
atom249*((Ixz6*atom248+atom249*Izz6)*dda6+atom5560*mx6+dB6*(Izz6*atom5516-atom5574)-atom5575*dB6+Izz6*ddB6+atom5516*atom5580-my6*atom5559)+(my6*atom5561-atom4586*atom5580+(atom249*Ixz6+atom248*Ixx6)*dda6+dB6*atom5585-atom5560*mz6+Ixy6*ddB6-(atom4586*Ixx6-atom5581)*dB6)*atom248;
Iyy1*ddB1-atom5005*atom4936-dB1*(atom4030*Ixy1-atom4936*Iyz1)+dda1*(atom80*Iyz1+atom79*Ixy1)+atom4030*atom4995+mz1*atom4979-atom4981*mx1;
-mx2*atom5097+mz2*atom5095-atom5121*atom5052+atom5111*atom4130+dB2*(Iyz2*atom5052-atom4130*Ixy2)+(atom103*Ixy2+Iyz2*atom104)*dda2+Iyy2*ddB2;
(atom5168*Iyz3-atom4244*Ixy3)*dB3-atom5168*atom5237+Iyy3*ddB3+atom4244*atom5227+dda3*(Iyz3*atom128+Ixy3*atom127)-atom5213*mx3+atom5211*mz3;
atom5327*mz4-mx4*atom5329-atom5353*atom5284+atom4358*atom5343+dB4*(atom5284*Iyz4-Ixy4*atom4358)+Iyy4*ddB4+dda4*(atom168*Ixy4+atom169*Iyz4);
atom5443*mz5-atom5469*atom5400-mx5*atom5445+ddB5*Iyy5+dB5*(Iyz5*atom5400-atom4472*Ixy5)+atom4472*atom5459+(atom209*Iyz5+atom208*Ixy5)*dda5;
ddB6*Iyy6+(atom249*Iyz6+Ixy6*atom248)*dda6-atom5561*mx6+atom5575*atom4586-atom5516*atom5585-dB6*(Ixy6*atom4586-atom5516*Iyz6)+atom5559*mz6;
atom86*((atom4946-ddB1)*mx1+(atom4941+atom4937)*my1-mz1*(atom4944+atom4947))+((atom4942+atom4938)*mx1-my1*(atom4947+atom4943)-mz1*(atom4941-atom4937))*atom82+atom85*(mz1*(atom4946+ddB1)-(atom4944+atom4943)*mx1-(atom4942-atom4938)*my1);
atom110*((atom5053+atom5057)*my2-mz2*(atom5063+atom5060)-mx2*(ddB2-atom5062))+atom109*((atom5054-atom5058)*my2-mx2*(atom5059+atom5060)+mz2*(ddB2+atom5062))-((atom5059+atom5063)*my2-mz2*(atom5053-atom5057)-(atom5054+atom5058)*mx2)*atom106;
-(mz3*(atom5179+atom5176)-my3*(atom5173+atom5169)-(atom5178-ddB3)*mx3)*atom149+atom148*((atom5178+ddB3)*mz3-my3*(atom5174-atom5170)-(atom5175+atom5176)*mx3)-atom130*(my3*(atom5175+atom5179)+mz3*(atom5173-atom5169)-(atom5174+atom5170)*mx3);
-((atom5291+atom5295)*my4-mx4*(atom5286+atom5290)-mz4*(atom5285-atom5289))*atom171+((atom5285+atom5289)*my4+mx4*(atom5294-ddB4)-(atom5295+atom5292)*mz4)*atom189+atom188*(my4*(atom5286-atom5290)-mx4*(atom5291+atom5292)+mz4*(atom5294+ddB4));
atom228*((atom5402-atom5406)*my5+mz5*(atom5410+ddB5)-mx5*(atom5408+atom5407))-((atom5407+atom5411)*my5-mx5*(atom5402+atom5406)-mz5*(atom5401-atom5405))*atom211+atom229*((atom5410-ddB5)*mx5-mz5*(atom5408+atom5411)+(atom5401+atom5405)*my5);
atom269*((atom5526-ddB6)*mx6+(atom5521+atom5517)*my6-(atom5527+atom5524)*mz6)+atom268*(my6*(atom5518-atom5522)+mz6*(atom5526+ddB6)-(atom5523+atom5524)*mx6)-(my6*(atom5527+atom5523)-(atom5518+atom5522)*mx6+mz6*(atom5521-atom5517))*atom251+atom5536*m6];

%endfunction
